구현이 너무 난해하여 생략.
